% -*- latex -*-
%
% $Id: brief.tex,v 1.17 2002/07/18 02:38:44 ngorsuch Exp $
%
% $COPYRIGHT$
%

\section{Quick Start OSCAR Installation on a Private Subnet}
\label{sec:quick-start}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Why you shouldn't do a Quick Start install}

If you meet the criteria listed below and are very brave, you can try
to install your cluster using the brief, mysterious, cryptic, terse,
and obscure documentation in this section.  Only those users who meed
and understand all of the following criteria should attempt to use
this ``Quick Start'' installation guide:

\begin{enumerate}
\item You hate to read manuals, documentation, or other printed
  matter.
\item You are a UNIX guru (you can use \cmd{netcfg} or an editor to
  configure network interfaces).
\item Your cluster client nodes are on a private subnet.
\item Your cluster server node has two network interfaces, one
  public, and one connected to the cluster client machines.
\item The default RPM list supplied by OSCAR for your distribution
  (\file{oscar\--\oscarversion/\-oscarsamples/\-<distro>-<version>-<arch>.rpmlist})
  is acceptable for your client nodes.
\item You are using a distribution that is listed as \emph{Fully
    supported} in Table~\ref{tab:oscar-distro-support}.
\item You know how to install your chosen distribution on a node.
\item You've never read completely through the installation
  instructions of anything, ever.
\end{enumerate}

\docswitch{}{\input{supported}}

If you decide that the quick install isn't for you, see the detailed
installation instructions \docswitch{in Section~\ref{sec:detail}
  (page~\pageref{sec:detail}).  Throughout the quick install
  instructions, there are references to the appropriate section in the
  detailed installation instructions in parentheses at the end of each
  step.}{in the full OSCAR installation guide.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Quick installation procedures}

All actions specified herein should be performed by the \user{root}
user on the server node unless noted otherwise.  Note that if you
login as a regular user and use the \cmd{su} command to change to the
\user{root} user, you {\em must} use ``\cmd{su -}'' to get the full
\user{root} environment.  Using ``\cmd{su}'' (with no arguments) may
not be sufficient, and may cause obscure errors during an OSCAR
installation.

\begin {enumerate}
\item Install (or already have installed) Linux on your server
  machine.  The only requirements for your Linux installation are:

  \begin{enumerate}
  \item There should be approximately 2GB free space in both the
    \file{/} and \file{/var} filesystems. It may be simplest if you
    just create one large partition on the entire drive containing at
    least 4GB of free space
    
    \sbsdetail{det:serverdiskpar}
  \item An X windowing system such as GNOME or KDE must be installed.
  \item Networking must be set up and working on the public interface.
    (Do yourself a favor and install some type of network security
    if your system is exposed to the general internet. Oscar installs
    a firewall package called pfilter that may be used for this,
    but does not turn it on by default.)
  \item The second network interface for the private cluster network
    must be installed
  \end{enumerate}
  
  \sbsdetail{det:serverosinstall}
  
\item After the installation is complete, log on as \user{root} to the
  server node.
  
\item Download a ``Regular'' or ``Extra Crispy'' distribution of OSCAR
  (see Section~\ref{sec:download} on page~\pageref{sec:download}).
  The rest of these instructions assume that the OSCAR distribution
  file was downloaded into \user{root}'s home directory --
  \file{$^\sim$root}.

\item Expand the OSCAR distribution:

\begin{verbatim}
  # cd ~
  # tar zxf <filename>
\end{verbatim}
  
  Where \file{$<$filename$>$} is either
  \file{oscar-\oscarversion.tar.gz} (regular distribution) or
  \file{oscar\--including\--srpms\--\oscarversion.tar.gz} (extra crispy
    distribution).

  \sbsdetail{det:unpack}

\item Copy all the rpms from \emph{all} of the distribution CD's to
  \file{/tftpboot/rpm} using these, or similar, commands:

\begin{verbatim}
  (insert cd)
  # cp /mnt/cdrom/Redhat/RPMS/*.rpm /tftpboot/rpm
\end{verbatim}

  \sbsdetail{det:rpmcopy}

\item Get all the relevant updates for your Linux distribution and
  install them them on the server node.  Additionally, copy them
  updated RPM files to \file{/tftpboot/rpm} with the RPMs from the
  installation CDs.
  
  \sbsdetail{det:distro-updates}

\item Configure the second (private) cluster network adapter using a
  command such as \cmd{/usr/sbin/netcfg}, or your favorite editor.
  Set the interface address to a relatively high IP address on the
  private network (e.g., 10.0.0.250), set the interface configuration
  protocol to ``none'', and set the interface to activate at boot
  time.  

\sbsdetail{det:serveradapter}

\item Reboot the server node.  
  
\item After the reboot is complete, log on as \user{root}, and ensure
  that the private network interface came up properly.
  
\item If X is not automatically launched upon \user{root} login, start
  an X windowing system such as GNOME or KDE.
  
\item Change to the OSCAR top-level directory (assumedly,
  \file{$^\sim$root/oscar-\oscarversion}), and run the following
  command to start the OSCAR installation:

\begin{verbatim}
  # ./install_cluster <device>
\end{verbatim}
  
  In the above command, substitute the device name (e.g., \emph{eth1})
  in place of \cmd{$<$device$>$} for your server's private network
  ethernet adapter.  After \cmd{install\_cluster} successfully
  completes some initial setup, it will display the OSCAR wizard GUI.

  \sbsdetail{det:installcluster}

\item Press the \button{Prepare OSCAR Server for Install} button.
  This will bring up a window for you to select which MPI
  implementation you wish to use as the system default.  This step
  also installs and starts over necessary software, devices, and
  services.

  \sbsdetail{det:prepareforinstall}

\item Press the \button{Build OSCAR Client Image} button.  This pops
  up the ``Create a SystemImager Image'' window. Verify that the last
  part of the filename in the \field{Disk Partition File} field
  matches the type of drives that are in your clients. OSCAR ships
  \file{sample.disk.ide} and \file{sample.disk.scsi} in the
  \file{oscarsamples} directory.  Press the \button{BuildImage} button
  to build a SystemImager image for installation to the compute nodes.
  You will see a progress bar across the bottom of the window as the
  image is built.  A dialog will pop up when the build is complete.
  When it is successful, press the \button{Close} button on the pop up
  window and then the \button{Close} button on the ``Build a
  SystemImager Image'' window. You have just built an installation
  image on the server node with the name \file{oscarimage}.

  \sbsdetail{det:buildimage}
  
\item Press the \button{Define OSCAR Clients} button on the OSCAR
  Wizard.  On the window that is opened, fill in the number of client
  nodes that your cluster contains. Verify that the IP information is
  correct and correct if it is not.  Pay special attention to the
  domain name. {\bf This is absolutely required: ensure that a domain
    name is filled in.}  Press the \button{Addclient} button to define
  the clients. Once that is complete a dialog will pop up.  If it is
  successful, press the \button{Close} button on the pop up window and
  then the \button{Close} button on the ``Define OSCAR Clients''
  window.

  \sbsdetail{det:defclients}
  
\item Press the \button{Setup Networking} button on the OSCAR Wizard.
  The window that is opened will help you collect MAC addresses and
  configure the remote boot services. If your client nodes do not
  support PXE booting, you will need to create a boot diskette. Put a
  diskette in the floppy drive and press the \button{Build Autoinstall
    Floppy} button. You may create multiple diskettes if you like.

  \sbsdetail{det:setupnetwork}

\item Press the \button{Collect MAC Addresses} button. The wizard will
  start scanning the network as indicated in the message at the top of
  the window.

  \sbsdetail{det:setupnetwork}
  
\item Now you need to network boot your nodes. This is done in one of
  two ways:

  \begin{itemize}
  \item If your nodes support PXE booting, set the boot order in the
    BIOS to have the network adapter first.
  \item If your nodes do not support PXE, insert the boot floppy
    created in the previous step and boot off the floppy
  \end{itemize}
        
  \sbsdetail{app:net-boot-client-nodes}
  
\item As the nodes broadcast over the network, the MAC addresses
  detected will show up on the left side of the window. Select a MAC
  address and select its corresponding client. Press the
  \button{Assign Mac to Node} button to give the node that MAC
  address.  After the MAC is captured for each client node, you can
  power down that client node in preparation to reboot it later.

  \sbsdetail{det:setupnetwork}

\item When you have assigned a MAC address to each node, press the
  \button{Stop Collecting} button to stop scanning the network. Then
  press the \button{Configure DHCP Server} to setup the server to
  answer the client requests.

  \sbsdetail{det:setupnetwork}

\item If your clients support PXE booting, press the \button{Setup
    Network Boot} button to configure the server to answer PXE
  requests.

  \sbsdetail{det:setupnetwork}

\item Press \button{Close} to dismiss the network setup window.
  
\item Network boot the clients, as you did when collecting the MAC
  addresses. This time the clients will be answered by the server and
  will perform the actual client installation. The install should only
  take a few minutes depending on your hardware and your network.  You
  can install multiple clients simultaneously (note, however, that the
  more simultaneous installs that you perform, the slower each
  individual install may go).

  \sbsdetail{det:clientinstall}
  
\item As each client finishes, it will start beeping and printing a
  message to the console. You should now reboot them off of their
  newly installed hard disks.

  \begin{itemize}
  \item If you are using PXE boot, reboot the clients and set the BIOS
    boot order to boot to hard disk before the network.
  \item If you are using auto install diskettes, just remove the
    diskette and reboot.
  \end{itemize}

  \sbsdetail{det:clientfinish}
  
\item Once all the clients have successfully booted, Press the
  \button{Complete Cluster Setup} button. Your OSCAR cluster is now
  installed and configured.

  \sbsdetail{det:completeinstall}
  
\item To verify proper installation, you should test the cluster.
  OSCAR provides a test suite to verify the basic cluster functions.
  All compute nodes must be fully booted and available before
  attempting this step.  Press the \button{Test Cluster Setup} button.
  A window will pop up.  Enter the number of cluster nodes and the
  number of processors per node when prompted. The test will submit
  simple jobs to the cluster and print the output. Any errors or
  problems with the installation will show up in the output of the
  test script.

  \sbsdetail{det:testcluster}

\end{enumerate}
