% -*- latex -*-
%
% Copyright (c) 2002 The Trustees of Indiana University.
%                    All rights reserved.
%
% This file is part of the OSCAR software package.  For license
% information, see the COPYING file in the top level directory of the
% OSCAR source distribution.
%
% $Id: release-notes.tex,v 1.44 2003/11/26 23:53:35 bernardli Exp $


\section{Release Notes}
\label{sec:release-notes}

The following release notes apply to OSCAR version \oscarversion.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Release Features}
\label{subsec:release-features}

\begin{itemize}

\item x86\_64 support for Red Hat Enterprise Linux 3 \& 4,
\item Fedora Core 3, Red Hat Enterprise Linux 4 and 
      Mandriva Linux 10.1 support
\item New feature! ``Monitor Cluster Deployment'' in Wizard
\item Ganglia updated to v3.0.1
\item PVM updated to v3.4.5+4
\item Torque updated to v1.2.0p5
\item SystemImager updated to v3.5.3
\item MPICH updated to v1.2.7
\item AutoInstallFloppy changed to AutoInstallCD due to large kernel images.
\item Replaced tftp-server with atftp-server for better scalability
\item Software RAIDs on cluster nodes are now supported

\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Notes for All Systems}
\label{subsec:release-notes}

\begin{itemize}

\item The OSCAR installer GUI provides little protection for user
  mistakes.  If the user executes steps out of order, or provides
  erroneous input, Bad Things may happen.  Users are strongly
  encouraged to closely follow the instructions provided in this
  document.

\item Each package in OSCAR has its own installation and release
  notes.  \detailed{See Section~\ref{sec:pkg-specific-notes} for
  additional release notes.} \quick{See the full Installation Guide
  for these notes.}

\begchange
\item All nodes must have a hostname other than ``{\tt localhost}''
  that does not contain any underscores (``{\tt \_}'') or periods ``{\tt
  .}''.  Some distributions complicate this by putting a line such
  as as the following in /etc/hosts:
  \begin{verbatim}
    127.0.0.1   localhost.localdomain   localhost
    yourhostname.yourdomain    yourhostname
  \end{verbatim}
  If this occurs the file should be separated as follows:
  \begin{verbatim}
  127.0.0.1 localhost.localdomain localhost
  192.168.0.1 yourhostname.yourdomain yourhostname
  \end{verbatim}
\endchange

\item A domain name must be specified for the client nodes when
  defining them.

\item Although OSCAR can be installed on pre-existing server nodes, it
  is typically easiest to use a machine that has a new, fresh install
  of a distribution listed in Table~\ref{tab:oscar-distro-support}
  {\em with no updates installed}.  If the updates are installed,
  there may be conflicts in RPM requirements.  It is recommended to
  install Red Hat updates {\em after} the initial OSCAR installation has
  completed.

\item The ``Development Tools'' packages for are not default packages in
all distributions and are required for installation.

\item The following benign warning messages will appear multiple times
  during the OSCAR installation process:

\begin{verbatim}
  awk: cmd. line:2: fatal: cannot open file `/etc/fstab'
    for reading (No such file or directory)

  rsync_stub_dir: no such variable at ...

  Use of uninitialized value in pattern match (m//) at
  /usr/lib/perl5/site_perl/oda.pm ...
\end{verbatim}

  It is safe to ignore these messages.

\item The OSCAR installer will install the MySQL package on the server
  node if it is not already installed.  A random password will be automatically
  generated for the oscar user to access the oscar database.  This
  password will be stored in the file \file{/etc/odapw}.  It should
  not be needed by other users.

\item The OSCAR installer GUI currently does not support deleting a
  node and adding the same node back {\em in the same session}.  If
  you wish to delete a node and then add it back, you must delete the
  node, close the OSCAR installer GUI, launch the OSCAR installer GUI
  again, and then add the node.

\item If \cmd{ssh} produces warnings when logging into the compute
  nodes from the OSCAR head node, the C3 tools (e.g., \cmd{cexec}) may
  experience difficulties.  For example, if you use \cmd{ssh} to login
  in to the OSCAR head node from a terminal that does not support X
  windows and then try to run \cmd{cexec}, you might see a warning
  message in the \cmd{cexec} output:

\begin{verbatim}
  Warning: No xauth data; using fake authentication data for
  X11 forwarding.
\end{verbatim}

  Although this is only a warning message from \cmd{ssh}, \cmd{cexec}
  may interpret it as a fatal error, and not run across all cluster
  nodes properly (e.g., the \button{Install/Uninstall Packages} button
  will likely not work properly).

  Note that this is actually an \cmd{ssh} problem, not a C3 problem.
  As such, you need to eliminate any warning messages from ssh (more
  specifically, eliminate any output from \file{stderr}).  In the
  example above, you can tell the C3 tools to use the ``\cmd{-x}''
  switch to \cmd{ssh} in order to disable X forwarding:

\begin{verbatim}
  # export C3_RSH='ssh -x'
  # cexec uptime
\end{verbatim}

  The warnings about \cmd{xauth} should no longer appear (and the
  \button{Install/Uninstall Packages} button should work properly).

\item The SIS multicast facility (Flamethrower) is ``experimentally''
  supported.  If you are having problems with multicast and would like
  to experiment please check the {\tt oscar-users} and/or
  {\tt sisuite-users} mailing lists for tips.

%TJN: KEEP THIS (if we keep the python2-compat rpms under c3?)
\item Due to some distribution portability issues, OSCAR currently installs
  a ``compatibility''  (\file{python2\--compat\--1.0-1}) RPM to resolve the
  Python2 prerequisite that is slightly different across different Linux
  distributions.  Also see the file \file{packages/c3/RPMS/NOTE.python2}.

\item \emph{FutureWarning} message during APItests on Python2.3 based systems.
   The following is a warning message about the for the version of
   TwistedMatrix used by the APItest tool.  It is only a warning and can be
   ignored.
   \begin{small}
   \begin{verbatim}
   Running Installation tests for pvm
   /usr/lib/python2.3/site-packages/twisted/internet/defer.py:398:
   FutureWarning: hex()/oct() of negative int will return
   a signed string in Python 2.4 and up return "<%s at %s>" 
   % (cname, hex(id(self)))
   \end{verbatim}
   \end{small}

\item In some cases, the test window that is opened from the
  OSCAR wizard may close suddenly when there is a test failure. If
  this happens, run the test script, \file{testing/test\_cluster},
  manually in a shell window to diagnose the problem.

\item Oscar uses the atftp-server package instead of the tftp-server
  package which ships with many distributions.  The tftp-server rpm
  should be uninstalled, along with any packages which depend on it
  before the Oscar wizard is started.  Using the standard or
  ``workstation'' installation should avoid this issue.

\item On x86 systems using Red Hat Enterprise Linux 4 or Fedora Core 4,
  the pfilter package causes image deployment to freeze midway through,
  so it is necessary to uncheck the pfilter package during Step 1 
  \button{Select OSCAR Packages To Install} or turn it off prior to 
  network booting the nodes defined in Step 5 \button{Define OSCAR Clients}.
  To turn of pfilter, run the ``Services'' wiget found under the
  ``System Tools'' menu, select pfilter from the list of services, and
  click on stop.  Oscar will restart the service during a later step.

\item In some distributions, when using cshell, the 
  /etc/profile.d/less.csh script expects to find /etc/sysconfig/i18n. If 
  it's missing, as it is on every OSCAR compute node, ssh or login
  generates an error.  To correct the error, simply use 
  ``cpush /etc/sysconfig/i18n'' after install and updating affected images.
  Fedora Core 4 and RHEL4U2 should not be affected by this issue.

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Red Hat Enterprise Linux 4 \& Fedora Core 3 \& 4: SELinux Conflict }
\label{subsec:SELinuxnotes}

\begin{itemize}

\item Due to issues with displaying graphs under Ganglia, and installing
  RPMs in a SIS chroot environment (needed to build OSCAR images), SELinux 
  should be disabled before installing OSCAR.  During installation, it can be
  deactivated on the same screen as the firewall.  If it is currently
  active it can be turned off in /etc/selinux/config by setting SELINUX 
  to ``disabled'' and rebooting.

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Red Hat Enterprise Linux 4}
\label{subsec:rhel4notes}

\begin{itemize}

% TJN: Adding in respose to Bug#1271143
\item On Red Hat Enterprise Linux 4 Update 2 and CentOS 4.2 systems you 
      must remove the `tog-pegasus' RPM from the server, if installed, to 
      avoid file ownership conflicts with `pvm' on the compute nodes and SIS 
      image.  This is due to an ordering issue with the RPM installs which 
      both create system-level users which get out of ordering during OSCAR's 
      image build process.  See also:
      \begin{itemize}
		\item OSCAR Bug\#1368604 ``/opt/pvm3 directory ownership on image''
		\item OSCAR Bug\#1371143 ``docfix: tog-pegasus / pvm permission issues''
      \end{itemize}

\item On ia64 systems using Red Hat Enterprise Linux 4, it may be possible
  that proc remains mounted
  on the image after it has been built; this causes subsequent compute node
  installations (rsync) to fail.  To get around this problem, you need to
  umount the directory manually after image has been created and before
  installing the compute nodes.
 
  First, find out what is mounted by looking in {\tt /proc/mounts} with
  \begin{verbatim}
# cat /proc/mounts
  \end{verbatim}
  It should list something like the following:
  \begin{verbatim}
proc /var/lib/systemimager/images/oscarimage/proc proc rw,nodiratime 0 0
none /var/lib/systemimager/images/oscarimage/proc/sys/fs/binfmt_misc
binfmt_misc rw 0 0
  \end{verbatim}
  Then umount the two directories that are mounted, e.g.,
  \begin{verbatim}
# umount -f /var/lib/systemimager/images/oscarimage/proc/sys/fs/binfmt_misc
# umount -f /var/lib/systemimager/images/oscarimage/proc"
  \end{verbatim}
  Note the ordering of the umount commands is important.

\item On ia64 systems using Red Hat Enterprise Linux 4, the ia32el.rpm is
  needed.  This rpm is located on the extra CDs.  Make sure you include
  the rpms from these disks when you copy the rpms into /tftpboot/rpm.

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{CentOS 4 ia64 Notes}
\label{subsec:centos4notes}

These items are specific to CentOS 4.  The items listed above for Red Hat
Enterprise Linux 4 also apply.

\begin{itemize}

\item The ia32el RPM is missing from CentOS, which prevents the successful
building of disk images on these systems.  To work around this, we suggest
downloading the RPM from this site \url{ftp://ftp.scientificlinux.org/linux/scientific/41/ia64/SL/RPMS/ia32el-1.2-4.ia64.rpm}
%\end{verbatim}
and placing it in the /tftpboot/rpm directory.  This package contains the
ia32 execution layer needed for running ia32 applications and is included
in most other Red Hat based distributions by default.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Red Hat Enterprise Linux 3}
\label{subsec:rhel3notes}

\begin{itemize}

\item The efibootmgr (from package elilo) isn't able to deal with the 
efi variables in /sys (as in the new installation kernel). It expects 
to find them in /proc. This means that at the end of the installation 
systemconfigurator isn't able to add the necessary entry to the efi 
boot menu. The system will not boot and reinstall itself indefinitely.

To fix this issue download the RPM \url{ftp://ftp.scientificlinux.org/linux/scientific/41/ia64/SL/RPMS/elilo-3.4-10.ia64.rpm}.

Unpack its contents to some subdirectory:
\begin{verbatim}
 mkdir t
 cd t
 rpm2cpio ../elilo-3.4-10.ia64.rpm | cpio -i -d
\end{verbatim}
Replace \$IMAGEDIR/usr/sbin/efibootmgr with the file from the new elilo rpm:
 cp usr/sbin/efibootmgr \$IMAGEDIR/usr/sbin

Install the node.

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Mandriva Linux (previously known as "Mandrake Linux") Notes}
\label{subsec:mdk10notes}

The versions of Mandriva Linux officially supported in OSCAR 4.2 are
Mandriva Linux 10.0 Official (3 cd set) and Mandriva Linux 10.1 Official, 
PowerPack edition (6 cd set). While it is possible to install OSCAR 4.2 under 
others editions of those versions of Mandriva Linux, the above mentioned are
those officially supported by the OSCAR development team. Please read 
carefully the sub-items bellow and follow the installation instructions
with attention. 

\begin{itemize}

\item Common notes

When openssh-server is installed in Mandriva systems (during Step 3)
its config file is usually set to "NOT permit root login" by default.
Since OSCAR needs to be able to login as root via ssh, you have to edit the
file \file{/etc/ssh/sshd{\tt \_}config} whether by setting 
'PermitRootLogin yes' or by commenting/deleting this entire line. This must 
be done before Stage 4 because this configuration file will be copied to the 
node's image and spread to all nodes during step 6. Remember to reload
the openssh server in the master node after this change:
\begin{verbatim}
  service sshd reload
\end{verbatim}

\item Mandriva 10.0 Official specific notes

During Step 3, \button{Install OSCAR Server Packages}, the RPM package
\file{kernel-enterprise} will be selected to be installed on the head node.
As a result, this kernel will be used upon subsequent reboot.

While Mandriva Linux 10.0 supports 2.4 kernel, OSCAR only supports
2.6 kernel - this is explicitly specified in
\file{oscarsamples/mandrake-10.0-i386.rpmlist}.

The \file{tftp-server} RPM which came with Mandriva Linux 10.0 expects the
pxelinux boot files to reside in \file{/var/lib/tftpboot} but OSCAR puts
them in \file{/tftpboot}.  To get around this issue a symbolic link is
created from \file{/var/lib/tftpboot} to \file{/tftpboot}.


\item Mandriva 10.1 Official specific notes

As mentioned above, the officially supported edition of Mandriva Linux 10.1
is the PowerPack edition. However, the 3 cd set "Download Edition"
should work if the following packages are added to the repository of 
packages (/tftpboot/rpm):
\begin{verbatim}
  perl-PerlIO-gzip
  libecpg3
  perl-devel
  php-xml
  gcc-g77
  libf2c0
  zlib1-devel
\end{verbatim} 
Those packages are not present in the distribution cds and you will need to
download them from a FTP mirror (see \url{http://www1.mandrivalinux.com/en/ftp.php3}
for a list of mirrors).

The OpenSSH packages that came with Mandriva Linux 10.1 Official (version 
3.9p1-3mdk) have a bug concerning public keys under user's home directory 
shared by NFS. That means OSCAR won't work if we install OpenSSH from this 
source (version 3.9p1-3mdk). For now, it is necessary to delete the following 
three packages that were copied with the others under /tftpboot/rpm, get a copy 
of these same packages provided with Mandriva Linux 10.0 (version 3.6.1p2-12mdk) 
from a FTP miroir (see link for a list of mirroirs above) and copy them to 
/tftpboot/rpm, replacing the original packages:
\begin{verbatim}
  openssh
  openssh-clients
  openssh-server
\end{verbatim}

\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Fedora Core 4}
\label{subsec:fc4notes}

\begin{itemize}
\item Under Fedora Core 4, the following output may be ignored during 
Step 5, \button{Define OSCAR Clients}:
\begin{verbatim}
Argument "2.121_02" isn't numeric in subroutine entry at 
/usr/lib/perl5/site_perl/MLDBM/Serializer/Data/Dumper.pm line 5
\end{verbatim}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Fedora Core 2}
\label{subsec:fc2notes}

\begin{itemize}
\item On Fedora Core 2, the following output may be ignored during Step 8,
  \button{Test Cluster Setup}:
  \begin{verbatim}
    Can't find string terminator '"' anywhere before EOF at -e line 1
  \end{verbatim}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
