#!/bin/sh
#
# $Id: post_clients,v 1.1 2002/07/28 05:56:01 jsquyres Exp $
#
# post_clients script for the switcher package
#
# Setup the switcher.ini file on the head node to be syncronized
# across the cluster.
#

# Add /opt/switcher/etc/switcher.ini to /opt/opium/etc/opium.conf.
# This script may be re-run, so ensure that it is only listed in the
# file once.

sw_file=/opt/env-switcher/etc/switcher.ini
op_file=/opt/opium/etc/sync_users.conf
ret=0

if test ! -f $op_file; then
    cat <<EOF
***********************************************************************
OSCAR package: switcher
API call: post_clients
Error: OPIUM config file ($op_file) does not exist
***********************************************************************
EOF
    ret=1
elif test "`grep $sw_file $op_file`" = ""; then
    echo "syncfile $sw_file" >> $op_file
fi

# All done

exit $ret
