<?xml version="1.0" encoding="ISO-8859-1"?>

<oscar>
  <!--
      Copyright (c) 2003 NCSA 
                         All rights reserved.
      
      This file is part of the OSCAR software package.  For license
      information, see the COPYING file in the top level directory of the
      OSCAR source distribution.
     
      $Id: config.xml,v 1.51 2003/07/17 19:50:34 ngorsuch Exp $
  -->
  <name>oda</name>

  <!--
  =====================================================
  =====================================================
  ==                                                 ==
  ==    oda data for oda record in packages table    ==
  ==                                                 ==
  =====================================================
  =====================================================
  -->

  <version>
    <major>1</major>
    <minor>20</minor>
    <subversion>0</subversion>
    <release>1</release>
    <epoch>1</epoch>
  </version>

  <class>special</class>
  <installable>1</installable>

  <summary>Oscar DAtabase</summary>
  <license>Freely distributable</license>
  <group>Application/Environment</group>

  <packager>
    <name>Neil Gorsuch</name>
    <email>ngorsuch@ncsa.uiuc.edu</email>
  </packager>

  <maintainer>
    <name>Neil Gorsuch</name>
    <email>ngorsuch@ncsa.uiuc.edu</email>
  </maintainer>

  <description>ODA provides a central database for OSCAR.</description>

  <rpmlist>
    <filter group="oscar_server" distribution="redhat" distribution_version="7.3" />
    <filter group="oscar_server" distribution="rhas" distribution_version="2.1AS" />
    <rpm>mysql-server</rpm>
  </rpmlist>

  <rpmlist>
    <filter distribution="redhat" distribution_version="7.3" />
    <filter distribution="redhat" distribution_version="8.0" />
    <filter distribution="redhat" distribution_version="9"   />
    <filter distribution="rhas" distribution_version="2.1AS" />
    <rpm>perl-CGI</rpm>
    <rpm>mysql</rpm>
    <rpm>perl-DBD-MySQL</rpm>
    <rpm>perl-DBI</rpm>
  </rpmlist>

  <rpmlist>
    <filter group="oscar_server" distribution="mandrake" distribution_version="8.2" />
    <rpm>MySQL</rpm>
  </rpmlist>

  <rpmlist>
    <filter distribution="mandrake" distribution_version="8.2" />
    <rpm>MySQL-client</rpm>
    <rpm>libmysql10</rpm>
    <rpm>perl-CGI</rpm>
    <rpm>perl-DBI</rpm>
    <rpm>perl-Mysql</rpm>
    <rpm>perl-ExtUtils-PerlPP</rpm>
    <rpm>oda</rpm>
  </rpmlist>

  <rpmlist>
    <filter distribution='suse' />
      <rpm>mysql</rpm>
      <rpm>mysql-client</rpm>
      <rpm>perl-Msql-Mysql-modules</rpm>
      <rpm>perl-DBI</rpm>
      <rpm>perl-Data-ShowTable</rpm>
      <rpm>mysql-shared</rpm>
      <rpm>oda</rpm>
  </rpmlist>

  <package>
    <oda>
        <!--
        ===============================================
        ===============================================
        ==                                           ==
        ==        global shortcut definitions        ==
        ==                                           ==
        ===============================================
        ===============================================

	add_dns_server_to_node adds a dns server to a
	node record, required and only parameters are:

	dns_server    IP or dns name of dns server machine to add
	node          cluster node name of the record to modify

	 -->
	<shortcut> add_dns_server_to_node
 	           insert_record
                   nodes_included_dns_servers
                   nodes_included_dns_servers.server~%1
                   nodes.name=%2
                   nodes_included_dns_servers.node_id~nodes.id
        </shortcut>
        <!--

	add_node_to_cluster_partition adds a node to a cluster partition,
	required and only parameters are:

	node          name of the node to add
	partition     name of the cluster partition to add it to

	 -->
	<shortcut> add_node_to_cluster_partition modify_record 
	           nodes
	           nodes.name=%1
		   cluster_partitions.name=%2
		   nodes.cluster_partition_id~cluster_partitions.id
       
        </shortcut>
        <!--

	add_node_to_node_group adds a node to a node group
	required and only parameters are:

	node          name of the node to add
	group         name of the node group to add it to

	 -->
	<shortcut> add_node_to_node_group insert_record 
	           node_groups_included_nodes
	           nodes.name=%1
		   node_groups_included_nodes.node_id~nodes.id
		   node_groups.name=%2
		   node_groups_included_nodes.node_group_id~node_groups.id
       
        </shortcut>
        <!--

	add_package_set_to_node adds a software package set to a
	compute node record, required and only parameters are:

	set           name of the package set to add to the node
	node          name of the compute node record to add it to

	 -->
	<shortcut> add_package_set_to_node
                   insert_record
                   nodes_included_package_sets
                   package_sets.name=%1
                   nodes.name=%2
                   nodes_included_package_sets.node_id~nodes.id
                   nodes_included_package_sets.package_set_id~package_sets.id
        </shortcut>
        <!--

	add_package_to_package_set adds a software package set to
	a package set record, required and only parameters are:

	package       name of the package to add to the package set
	set           name of the package set record to add it to

	 -->
	<shortcut> add_package_to_package_set
                   insert_record
                   package_sets_included_packages
                   packages.name=%1
                   package_sets.name=%2
                   package_sets_included_packages.package_id~packages.id
                   package_sets_included_packages.package_set_id~package_sets.id
        </shortcut>
        <!--

	add_partition_to_disk_layout adds a disk partition to a
	disk layout record, required and only parameters are:

	name          partition name
	offset        offset of the start of the partition
	size          size of the partition
	type          type of the partition
	layout	      name of the disk layout record to add it to

	 -->
	<shortcut> add_partition_to_disk_layout
                   insert_record
                   disk_partitions
                   partition~%1
                   offset~%2
                   size~%3
                   type~%4
                   disk_layouts.name=%5
                   disk_layout_id~disk_layouts.id
        </shortcut>
	<shortcut> conflicts_with_package
                   read_records
                   packages_conflicts
                   package=%1
                   name
        </shortcut>
        <!--

	create_disk_layout creates a new disk layout record,
	required parameters are:

	name          name of the new disk layout record

	Optional parameters are:

	units         for offsets and sizes (default mb)

	 -->
	<shortcut> create_disk_layout
                   insert_record
                   disk_partitions
                   disk_partitions.name~%1
                   %+
        </shortcut>
        <!--

	create_image creates a new image record,
	required parameters are:

	name          name of the new image record

	Optional parameters are:

	path          base directory path on server

	 -->
	<shortcut> create_image
                   insert_record
                   images
                   images.name~%1
                   %+
        </shortcut>
        <!--

	create_network creates a new network record,
	required parameters are:

	name          name of the new network record

	Optional parameters are:

	cluster_only  non-zero if private cluster network

	 -->
	<shortcut> create_network
                   insert_record
                   networks
                   networks.name~%1
                   %+
        </shortcut>
        <!--

	create_nic_on_node creates a new network interface entry
	in a node record, required parameters are:

	nic name      name of the new network interface entry
	node name     name of the node record

	Optional parameters are:

        assignment    method of assigning IP "static" or "dhcp"
        broadcast     broadcast address of the network
        driver_module name of the associated driver module
        interface     name of the interface
        ip            ip address of the nic
        mac	      mac address of the nic
        netmask	      netmask mask of the network

	 -->
	<shortcut> create_nic_on_node
                   insert_record
                   nics
                   nics.name~%1
                   nodes.name=%2
                   nics.node_id~nodes.id
                   %+
        </shortcut>
        <!--

	create_node creates a new node record,
	 required parameters are:

	name          name of the node record

	Optional parameters are:

	cpu_num       number of processors
	cpu_speed     speed of processor(s)
	cpu_type      type of processor(s)
	default_gateway IP or dns name of the default gateway
	domain        dns domain of the node
	hostname      name of the node returned by hostname command
	ram           amount of ram in the node
	swap	      amount of swap space in the node
	units	      units for ram and swap

	 -->
	<shortcut> create_node
                   insert_record
                   nodes
                   nodes.name~%1
                   %+
        </shortcut>
        <!--

	create_cluster_partition creates a new cluster partition record,
	required parameters are:

	name          name of the cluster partition

	 -->
	<shortcut> create_cluster_partition
                   insert_record
                   cluster_partitions
                   cluster_partitions.name~%1
                   %+
        </shortcut>
        <!--

	create_node_group creates a new node group record,
	required parameters are:

	name          name of the node set

	 -->
	<shortcut> create_node_group
                   insert_record
                   node_groups
                   node_groups.name~%1
                   %+
        </shortcut>
        <!--

	create_package_set creates a new software package set record,
	required parameters are:

	name          name of the package set

	 -->
	<shortcut> create_package_set
                   insert_record
                   package_sets
                   package_sets.name~%1
                   %+
        </shortcut>
        <!--

	delete_all_cluster_partitions deletes all cluster partitions.

	The portions of this multiple commands shortcut do:
	Delete all cluster partition records.
	Set all node records partition id to undefined.
	 -->
	<shortcut> delete_all_cluster_partitions
                   delete_records
                   cluster_partitions
                   name=name
		   ;
		   modify_records
	           nodes
		   name=name
		   nodes.cluster_partition_id~undef
        </shortcut>
        <!--

	delete_all_node_groups deletes all node groups.

	The portions of this multiple commands shortcut do:
	Remove all records from node groups/included nodes table.
	Remove all records from node_groups names/ids table.
	 -->
	<shortcut> delete_all_node_groups
                   delete_records
                   node_groups_included_nodes
                   node_group_id=node_group_id
                   ;
                   delete_records
                   node_groups
                   name=name
        </shortcut>
        <!--

	delete_all_package_sets deletes all software packages.

	The portions of this multiple commands shortcut do:
	Set no selected package set in the oscar table.
	Remove all records from package sets/included packages table.
	Remove all records from package sets/included package sets table.
	Remove all records from nodes/included package sets table.
	Remove all records from package_set names/ids table.
	 -->
	<shortcut> delete_all_package_sets
                   modify_records
                   oscar
                   selected_package_set_id~0
                   ;
                   delete_records
                   package_sets_included_packages
                   package_set_id=package_set_id
                   ;
                   delete_records
                   nodes_included_package_sets
                   node_id=node_id
                   ;
                   delete_records
                   package_sets
                   name=name
        </shortcut>
	<shortcut> delete_disk_layout
                   delete_records
                   disk_partitions.disk_layout_id=disk_layouts.id
                   disk_layouts.name=%1
                   ;
                   delete_records
                   disk_layouts
                   name=%1
        </shortcut>
	<shortcut> delete_image
                   modify_records
                   nodes
                   nodes.image_id=images.id
                   images.name=%1
                   nodes.images_id~0
                   ;
                   delete_records
                   images
                   name=%1
        </shortcut>
	<shortcut> delete_network
                   modify_records
                   nics
                   nics.network_id=networks.id
                   networks.name=%1
                   nics.network_id~0
                   ;
                   delete_records
                   networks
                   name=%1
        </shortcut>
	<shortcut> delete_nic_from_node
                   delete_records
                   nics
                   nics.name=%1
                   nodes.name=%2
                   nics.node_id=nodes.id
        </shortcut>
	<shortcut> delete_node
                   delete_records
                   nics
                   nics.node_id=nodes.id
                   nodes.name=%1
                   ;
                   delete_records
                   node_groups_included_nodes
                   node_groups_included_nodes.node_id=nodes.id
                   nodes.name=%1
                   ;
                   delete_records
                   nodes_included_package_sets
                   nodes_included_package_set.node_id=nodes.id
                   nodes.name=%1
                   ;
                   modify_records
                   oscar
                   oscar.oscar_server_node_id=nodes.id
                   nodes.name=%1
                   oscar.oscar_server_node_id~0
                   ;
                   delete_records
                   nodes
                   name=%1
        </shortcut>
        <!--

	delete_node_group deletes a single node group.

	The portions of this multiple commands shortcut do:
	Remove all appropriate records from node groups/included nodes table.
	Remove the appropriate record from node_groups names/ids table.
	 -->
	<shortcut> delete_node_group
                   remove_all_nodes_from_node_group
                   %1
                   ;
                   delete_records
                   node_groups
                   name=%1
        </shortcut>
        <!--
	delete_cluster_partition deletes a single cluster partition.

	The portions of this multiple commands shortcut do:
	Set all node records that point to this partition to no partition.
	Delete the appropriate cluster partition record.
	 -->
	<shortcut> delete_cluster_partition
		   modify_records
	           nodes
                   cluster_partitions.name=%1
		   cluster_parititons.id=nodes.cluster_partition_id
		   nodes.cluster_partition_id~undef
		   ;
                   delete_records
                   cluster_partitions
                   cluster_partitions.name=%1
        </shortcut>
        <!--

	delete_package_set deletes a software package set record,
	required parameters are:

	name          name of the package set

	The portions of this multiple commands shortcut do:
	Set no selected package set if the deleted package was selected, in the oscar table.
	Remove all records for the deleted package set from the package sets/included packages table.
	Remove all records for the deleted package set from the package sets/included package sets table.
	Remove all records for the deleted package set from the nodes/included package sets table.
	Remove all records for the deleted package set from the package_set names/ids table.
	 -->
	<shortcut> delete_package_set
                   modify_records
                   oscar
                   oscar.selected_package_set_id=package_sets.id
                   package_sets.name=%1
                   oscar.selected_package_set_id~0
                   ;
                   remove_all_packages_from_package_set
                   %1
                   ;
                   remove_all_package_sets_from_package_set
                   %1
                   ;
                   delete_records
                   nodes_included_package_sets
                   nodes_included_package_sets.package_set_id=package_sets.id
                   package_sets.name=%1
                   ;
                   delete_records
                   package_sets
                   name=%1
        </shortcut>
	<shortcut> disk_layout_id_to_name
                   read_records
                   disk_layouts
                   id=%1
                   name
        </shortcut>
	<shortcut> disk_layout_name_to_id
                   read_records
                   disk_layouts
                   name=%1
                   id
        </shortcut>
	<shortcut> disk_layouts
                   read_records
                   disk_layouts.name
                   %+
        </shortcut>
	<shortcut> image_id_to_name
                   read_records
                   images
                   id=%1
                   name
        </shortcut>
	<shortcut> image_name_to_id
                   read_records
                   images
                   name=%1
                   id
        </shortcut>
	<shortcut> images
                   read_records
                   images.name
                   %+
                  
        </shortcut>
	<shortcut> link_node_nic_to_network
                   modify_records
                   nics
                   nodes.name=%1
                   nics.name=%2
                   networks.name=%3
                   nics.node_id~nodes.id
                   nics.network_id~networks.id
        </shortcut>
	<shortcut> link_node_to_disk_layout
                   modify_records
                   modes
                   nodes.name=%1
                   disk_layouts.name=%2
                   nodes.disk_layout_id~disk_layouts.id
        </shortcut>
	<shortcut> link_node_to_image
                   modify_records
                   nodes
                   nodes.name=%1
                   images.name=%2
                   nodes.image_id~images.id
        </shortcut>
	<shortcut> list_nics_on_node
                   read_records
                   nodes.name=%1
                   nics.node_id=nodes.id
                   nics.name
        </shortcut>
	<shortcut> list_node_nics_on_network
                   read_records
                   networks.name=%1
                   nics.node_id=nodes.id
                   nics.network_id=networks.id
                   nodes.name
                   nics.name
        </shortcut>
	<shortcut> list_nodes_in_disk_layout
                   read_records
                   disk_layouts.name=%1
                   disk_layouts.id=nodes.disk_layout_id
                   nodes.name
        </shortcut>
	<shortcut> list_nodes_in_image
                   read_records
                   images.name=%1
                   images.id=nodes.image_id
                   nodes.name
        </shortcut>
	<shortcut> list_nodes_on_network
                   read_records
                   networks.name=%1
                   nics.node_id=nodes.id
                   nics.network_id=networks.id
                   nodes.name
        </shortcut>
	<shortcut> list_nodes_using_dns_server
                   read_records
                   nodes_included_dns_servers.server=%1
                   nodes_included_dns_servers.node_id=nodes.id
                   nodes.name
        </shortcut>
	<shortcut> network_id_to_name
                   read_records
                   networks
                   id=%1
                   name
        </shortcut>
	<shortcut> network_name_to_id
                   read_records
                   networks
                   name=%1
                   id
        </shortcut>
	<shortcut> networks
                   read_records
                   networks.name
                   %+
        </shortcut>
	<shortcut> nics
                   read_records
                   nics.name
                   %+
        </shortcut>
	<shortcut> node_group_id_to_name
                   read_records
                   node_groups
                   id=%1
                   name
        </shortcut>
	<shortcut> node_group_name_to_id
                   read_records
                   node_groups
                   name=%1
                   id
        </shortcut>
	<shortcut> node_groups
                   read_records
                   node_groups
                   node_groups.name
                   %+
        </shortcut>
	<shortcut> node_cluster_only_ips
                   read_records
                   nodes.name=%1
                   nics.node_id=nodes.id
                   nics.network_id=networks.id
                   networks.cluster_only!=0
                   nics.ip
        </shortcut>
	<shortcut> cluster_partition_id_to_name
                   read_records
                   cluster_partitions
                   id=%1
                   name
        </shortcut>
	<shortcut> cluster_partition_name_to_id
                   read_records
                   cluster_partitions
                   name=%1
                   id
        </shortcut>
	<shortcut> cluster_partitions
                   read_records
                   cluster_partitions
                   cluster_partitions.name
                   %+
        </shortcut>
	<shortcut> node_hostname_to_name
                   read_records
                   nodes
                   hostname=%1
                   name
        </shortcut>
	<shortcut> node_id_to_name
                   read_records
                   nodes
                   id=%1
                   name
        </shortcut>
	<shortcut> node_ips
                   read_records
                   nodes.name=%1
                   nics.node_id=nodes.id
                   nics.network_id=networks.id
                   nics.ip
        </shortcut>
	<shortcut> node_name_to_hostname
                   read_records
                   nodes
                   name=%1
                   hostname!=undef
                   hostname
        </shortcut>
	<shortcut> node_name_to_id
                   read_records
                   nodes
                   name=%1
                   id
        </shortcut>
	<shortcut> node_public_ips
                   read_records
                   nodes.name=%1
                   nics.node_id=nodes.id
                   nics.network_id=networks.id
                   networks.cluster_only=0
                   nics.ip
        </shortcut>
	<shortcut> nodes
                   read_records
                   nodes
                   nodes.name
                   %+
        </shortcut>
	<shortcut> nodes_cluster_only_ips
                   read_records
                   nics.node_id=nodes.id
                   nics.network_id=networks.id
                   networks.cluster_only!=0
                   nics.ip
        </shortcut>
        <!--

	nodes_in_node_group lists the nodes in a given node group.
	required parameters are:

	group      name of the node group

	 -->
	<shortcut> nodes_in_node_group
                   read_records
                   node_groups.name=%1
                   node_groups.id=node_groups_included_nodes.node_group_id
                   node_groups_included_nodes.node_id=nodes.id
                   nodes.name
		   %+
        </shortcut>
        <!--

	nodes_in_cluster_partition lists the nodes that are in a cluster partition.
	required parameters are:

	name          name of the cluster partition

	 -->
	<shortcut> nodes_in_cluster_partition
                   read_records
                   cluster_partitions.name=%1
                   cluster_partitions.id=nodes.cluster_partition_id
                   nodes.name
        </shortcut>
	<shortcut> nodes_public_ips
                   read_records
                   nics.node_id=nodes.id
                   nics.network_id=networks.id
                   networks.cluster_only=0
                   nics.ip
        </shortcut>
	<shortcut> oscar_server_node
                   read_records
                   oscar.oscar_server_node_id!=undef
                   oscar.oscar_server_node_id=nodes.id
                   nodes.name
        </shortcut>
	<shortcut> oscar_version
                   read_records
                   oscar.oscar_version!=undef
                   oscar.oscar_version
        </shortcut>
	<shortcut> package_id_to_name
                   read_records
                   packages
                   id=%1
                   name
        </shortcut>
	<shortcut> package_id_to_name_version
                   read_records
                   packages
                   id=%1
                   name
                   version
        </shortcut>
	<shortcut> package_name_to_id
                   read_records
                   packages
                   name=%1
                   id
        </shortcut>
	<shortcut> package_name_version_to_id
                   read_records
                   packages
                   name=%1
                   version=%2
                   id
        </shortcut>
	<shortcut> package_set_id_to_name
                   read_records
                   package_sets
                   id=%1
                   name
        </shortcut>
	<shortcut> package_set_name_to_id
                   read_records
                   package_sets
                   name=%1
                   id
        </shortcut>
	<shortcut> package_sets
                   read_records
                   package_sets.name
                   %+
        </shortcut>
	<shortcut> packages
                   read_records
                   packages
                   packages.name
                   %+
        </shortcut>
	<shortcut> packages_conflicts_with_package
                   read_records
                   packages_conflicts
                   package=%1
                   type="package"
                   name
        </shortcut>
        <shortcut> packages_in_package_set
                   read_records
                   package_sets.name=%1
                   package_sets.id=package_sets_included_packages.package_set_id
                   package_sets_included_packages.package_id=packages.id
                   packages.name
                   %+
        </shortcut>
        <shortcut> packages_in_selected_package_set
                   packages_in_package_set
                   package_sets.name
                   oscar.selected_package_set_id=package_sets.id
                   %+
        </shortcut>
	<shortcut> packages_installable
                   packages
                   packages.installable!=0
                   %+
        </shortcut>
        <shortcut> packages_installable_in_selected_package_set
                   packages_in_selected_package_set
                   packages.installable!=0
                   %+
        </shortcut>
	<shortcut> packages_provided_by_package
                   provided_by_package
                   %1
                   packages_provides.type="package"
        </shortcut>
	<shortcut> packages_required_by_package
                   required_by_package
                   %1
                   packages_requires.type="package"
        </shortcut>
	<shortcut> packages_that_conflict
                   read_records
                   packages_conflicts
                   packages_conflicts.name=%1
                   packages_conflicts.package
                   %+
        </shortcut>
	<shortcut> packages_that_conflict_package
                   packages_that_conflict
                   %1
                   packages_conflicts.type="package"
        </shortcut>
	<shortcut> packages_that_provide
                   read_records
                   packages_provides
                   packages_provides.name=%1
                   packages_provides.package
                   %+
        </shortcut>
	<shortcut> packages_that_provide_package
                   packages_that_provide
                   %1
                   packages_provides.type="package"
        </shortcut>
	<shortcut> packages_that_require
                   read_records
                   packages_requires
                   packages_requires.name=%1
                   packages_requires.package
        </shortcut>
	<shortcut> packages_that_require_package
                   packages_that_require
                   %1
                   packages_requires.type="package"
        </shortcut>
	<shortcut> packages_uninstallable
                   packages
                   packages.installable=0
                   %+
        </shortcut>
	<shortcut> provided_by_package
                   read_records
                   packages_provides
                   packages_provides.package=%1
                   packages_provides.name
                   %+
        </shortcut>
	<shortcut> remove_all_nodes_from_all_node_groups
                   delete_records
                   node_groups_included_nodes
                   node_group_id=node_group_id
        </shortcut>
	<shortcut> remove_all_nodes_from_node_group
                   delete_records
                   node_groups_included_nodes
                   node_groups.name=%1
                   node_groups.id=node_groups_included_nodes.node_group_id
        </shortcut>
	<shortcut> remove_node_from_all_node_groups
                   delete_records
                   node_groups_included_nodes
                   nodes.name=%1
		   node_groups_included_nodes.node_id=nodes.id
        </shortcut>
	<shortcut> remove_node_from_node_group
                   delete_records
                   node_groups_included_nodes
		   nodes.name=%1
                   node_groups.name=%2
                   node_groups.id=node_groups_included_nodes.node_group_id
                   nodes.id=node_groups_included_nodes.node_id
        </shortcut>
	<shortcut> remove_node_from_cluster_partitions
                   modify_records
                   nodes
                   nodes.name=%1
                   nodes.cluster_partition_id=undef
        </shortcut>
	<shortcut> remove_package_from_all_package_sets
                   delete_records
                   package_sets_included_packages
                   packages.name=%1
                   packages.id=package_sets_included_packages.package_id
        </shortcut>
	<shortcut> remove_disk_partition_from_disk_layout
                   delete_records
                   disk_partitions
                   disk_partitions.partition=%1
                   disk_layouts.name=%2
                   disk_layouts.id=disk_partitions.disk_layout_id
        </shortcut>
	<shortcut> remove_dns_server_from_node
                   delete_records
                   nodes_included_dns_servers
                   nodes_included_dns_servers.server=%1
                   nodes.name=%2
                   nodes_included_dns_servers.node_id=nodes.id
        </shortcut>
	<shortcut> remove_package_from_package_set
                   delete_records
                   package_sets_included_packages
                   packages.name=%1
                   package_sets.name=%2
                   package_sets.id=package_sets_included_packages.package_set_id
                   package_sets_included_packages.package_id=packages.id</shortcut>
	<shortcut> remove_package_set_from_node
                   delete_records
                   nodes_included_package_sets
                   nodes_included_package_sets.package_set_id=package_sets.id
                   package_sets.name=%1
                   nodes.name=%2
                   nodes_included_package_sets.node_id=nodes.id
        </shortcut>
	<shortcut> rename_disk_layout
                   modify_records
                   disk_layouts
                   name=%1
                   name~%2
        </shortcut>
	<shortcut> rename_image
                   modify_records
                   images
                   name=%1
                   name~%2
        </shortcut>
	<shortcut> rename_network
                   modify_records
                   networks
                   name=%1
                   name~%2
        </shortcut>
	<shortcut> rename_node
                   modify_records
                   nodes
                   name=%1
                   name~%2
        </shortcut>
	<shortcut> rename_node_group
                   modify_records
                   node_groups
                   name=%1
                   name~%2
        </shortcut>
	<shortcut> rename_cluster_partition
                   modify_records
                   cluster_partitions
                   name=%1
                   name~%2
        </shortcut>
	<shortcut> rename_node_nic
                   modify_records
                   nics
                   nodes.name=%1
                   nics.name=%2
                   nics.node_id=nodes.id
                   nics.name~%3
        </shortcut>
	<shortcut> rename_package_set
                   modify_records
                   package_sets
                   name=%1
                   name~%2
        </shortcut>
	<shortcut> required_by_package
                   read_records
                   packages_requires
                   packages_requires.package=%1
                   packages_requires.name
                   %+
        </shortcut>
	<shortcut> selected_package_set
                   read_records
                   oscar.selected_package_set_id!=undef
                   oscar.selected_package_set_id=package_sets.id
                   package_sets.name
        </shortcut>
	<shortcut> oscar_server_distribution
                   read_records
		   oscar
                   oscar_server_distribution!=undef
                   oscar_server_distribution
        </shortcut>
	<shortcut> oscar_server_distribution_version
                   read_records
		   oscar
		   oscar_server_distribution_version!=undef
                   oscar_server_distribution_version
        </shortcut>
	<shortcut> set_package_installable
                   modify_records
                   packages
                   name=%1
                   installable~1
        </shortcut>
	<shortcut> set_package_uninstallable
                   modify_records
                   packages
                   name=%1
                   installable~0
        </shortcut>
	<shortcut> set_oscar_server_node
                   modify_records
                   nodes.name=%1
                   oscar.oscar_server_node_id~nodes.id
        </shortcut>
	<shortcut> set_selected_package_set
                   modify_records
                   package_sets.name=%1
                   oscar.selected_package_set_id~package_sets.id
        </shortcut>
	<shortcut> unlink_node_from_disk_layouts
                   modify_records
                   nodes
                   nodes.name=%1
                   nodes.disk_layout_id~undef
        </shortcut>
	<shortcut> unlink_node_from_images
                   modify_records
                   nodes
                   nodes.name=%1
                   nodes.image_id~undef
        </shortcut>
	<shortcut> unlink_node_nic_from_networks
                   modify_records
                   nics
                   nodes.name=%1
                   nics.name=%2
                   nics.node_id=nodes.id
                   nics.network_id~undef
        </shortcut>
	<shortcut> which_disk_layout_has_node
                   read_records
                   disk_layouts.id=nodes.disk_layout_id
                   nodes.name=%1
                   disk_layouts.name
        </shortcut>
	<shortcut> which_image_has_node
                   read_records
                   images.id=nodes.image_id
                   nodes.name=%1
                   images.name
        </shortcut>
	<shortcut> which_networks_have_node
                   read_records
                   nodes.name=%1
                   nics.node_id=nodes.id
                   nics.network_id=networks.id
                   networks.name
        </shortcut>
	<shortcut> which_cluster_partition_has_node
                   read_records
                   nodes.name=%1
                   nodes.cluster_partition_id=cluster_partitions.id
                   cluster_partitions.name
        </shortcut>
	<shortcut> which_node_groups_have_node
                   read_records
                   nodes.name=%1
                   nodes.id=node_groups_included_node_groups.node_id
                   node_groups_included_nodes.included_node_id=node_groups.id
                   node_groups.name
        </shortcut>
	<shortcut> which_package_sets_have_package
                   read_records
                   packages.name=%1
                   package_sets_included_packages.package_id=packages.id
                   package_sets_included_packages.package_set_id=package_sets.id
                   package_sets.name
        </shortcut>
        <!--
        This defines the second field name for records in 
	the packages_rpmlist which can't be surmised from 
	the xml structure. If there were more than one 
	field name that needed to be specified for a 
	particular table, they would be specified all on 
	the same line.
        -->
        <fieldnames> packages_rpmlist scope </fieldnames>
     </oda>
  </package>

  <!--
  ==================================================
  ==================================================
  ==                                              ==
  ==    definitions of global database tables     ==
  ==                                              ==
  ==================================================
  ==================================================
   -->

  <database_tables>

    <cluster_partitions>
      <fields> 
        <id> 
	  <type> integer </type>
	  <parameters> auto_increment not null unique primary key </parameters>
	</id>
        <name>
	  <parameters> not null unique </parameters>
	</name>
      </fields>
    </cluster_partitions>

    <disk_layouts>
      <fields> 
        <id> 
	  <type> integer </type>
	  <parameters> auto_increment not null unique primary key </parameters>
	</id>
        <name>
	  <parameters> not null unique </parameters>
	</name>
        <units> 
	  <default> mb </default>
	</units>
      </fields>
    </disk_layouts>

    <disk_partitions>
      <fields> 
        <active/>
        <bootable/>
        <disk_layout_id>
	  <type> integer </type>
	</disk_layout_id>
        <mount_point/>
        <offset>
	  <type> integer </type>
	</offset>
        <partition/>
        <size>
	  <type> integer </type>
	</size>
        <type/>
      </fields>
    </disk_partitions>

    <images>
      <fields> 
        <id> 
	  <type> integer </type>
	  <parameters> auto_increment not null unique primary key </parameters>
	</id>
        <name>
	  <parameters> not null unique </parameters>
	</name>
        <path/>
      </fields> 
    </images>

    <networks>
      <fields> 
        <cluster_only> 
	  <type> integer </type>
	</cluster_only>
        <id> 
	  <type> integer </type>
	  <parameters> auto_increment not null unique primary key </parameters>
	</id>
        <name>
	  <parameters> not null unique </parameters>
	</name>
      </fields> 
    </networks>

    <nics>
      <fields> 
        <assignment_method/>
        <broadcast/>
        <driver_module/>
        <id> 
	  <type> integer </type>
	  <parameters> auto_increment not null unique primary key </parameters>
	</id>
        <interface/>
        <ip/>
        <mac/>
        <netmask/>
        <network_id>
	  <type> integer </type>
	</network_id>
        <node_id>
	  <type> integer </type>
	</node_id>
      </fields> 
    </nics>

    <node_groups>
      <fields> 
        <id> 
	  <type> integer </type>
	  <parameters> auto_increment not null unique primary key </parameters>
	</id>
        <name>
	  <parameters> not null unique </parameters>
	</name>
      </fields>
    </node_groups>

    <node_groups_included_nodes>
      <parameters> unique(node_id,node_group_id) </parameters>
      <fields> 
        <node_id>
	  <type> integer </type>
	</node_id>
        <node_group_id>
	  <type> integer </type>
	</node_group_id>
      </fields>
    </node_groups_included_nodes>

    <nodes_included_package_sets>
      <parameters> unique(node_id,package_set_id) </parameters>
      <fields> 
        <package_set_id>
	  <type> integer </type>
	</package_set_id>
        <node_id>
	  <type> integer </type>
	</node_id>
      </fields>
    </nodes_included_package_sets>

    <nodes>
      <fields> 
        <cluster_partition_id> 
	  <type> integer </type>
	</cluster_partition_id>
        <cpu_num> 
	  <type> integer </type>
	</cpu_num>
        <cpu_speed> 
	  <type> integer </type>
	</cpu_speed>
        <cpu_type/>
        <default_gateway/>
        <dns_domain/>
	<fqdn>
	  <parameters> unique </parameters>
	</fqdn>
        <hostname>
	  <parameters> unique </parameters>
	</hostname>
        <id> 
	  <type> integer </type>
	  <parameters> auto_increment not null unique primary key </parameters>
	</id>
        <image_id>
	  <type> integer </type>
	</image_id>
	<installer/>
        <name>
	  <parameters> not null unique </parameters>
	</name>
        <nis_domain/>
        <ram> 
	  <type> integer </type>
	</ram>
        <swap> 
	  <type> integer </type>
	</swap>
        <units> 
	  <default> mb </default>
	</units>
      </fields>
    </nodes>

    <nodes_included_dns_servers>
      <parameters> unique(node_id,server) </parameters>
      <fields> 
        <node_id>
	  <type> integer </type>
	</node_id>
        <server/>
      </fields>
    </nodes_included_dns_servers>

    <oda_shortcuts>
      <fields> 
        <expansion>
	  <type> text </type>
	  <parameters> not null </parameters>
	</expansion>
        <shortcut> 
	  <parameters> not null unique primary key </parameters>
	</shortcut>
      </fields>
    </oda_shortcuts>

    <oscar>
      <fields> 
        <installation_date/>
        <interface/>
	<oscar_server_distribution/>
	<oscar_server_distribution_version/>
        <oscar_server_node_id>
	  <type> integer </type>
	</oscar_server_node_id>
        <oscar_version/>
	<selected_package_set_id>
	  <type> integer </type>
	</selected_package_set_id>
      </fields>
    </oscar>

    <package_sets>
      <fields> 
        <id> 
	  <type> integer </type>
	  <parameters> auto_increment not null unique primary key </parameters>
	</id>
        <name>
	  <parameters> not null unique </parameters>
	</name>
      </fields>
    </package_sets>

    <package_sets_included_packages>
      <parameters> unique(package_id,package_set_id) </parameters>
      <fields> 
        <package_id>
	  <type> integer </type>
	</package_id>
        <package_set_id>
	  <type> integer </type>
	</package_set_id>
      </fields>
    </package_sets_included_packages>

    <!--
    Note that fields in the packages table will also
    be defined by the combination of all the fields 
    found in all of the config.xml files for each package.
    The selected field and another fields that are not
    found in the package config.xml files has to be
    defined here. All the fields are defined here anyway
    to ensure the types of fields and other things such
    as default values and whether fields are required to
    have a value.
    -->
    <packages>
      <fields>
        <class/>
	<copyright/>
	<description>
	  <type> text </type>
	</description>
        <directory/>
	<group/>
        <id> 
	  <type> integer </type>
	  <parameters> auto_increment not null unique primary key </parameters>
	</id>
	<installable/>
	<license/>
	<maintainer_email/>
	<maintainer_name/>
        <name>
	  <type> varchar(100) </type>
	  <parameters> not null </parameters>
	</name>
	<package/>
	<packager_email/>
	<packager_name/>
	<summary/>
	<url/>
	<vendor/>
        <version>
	  <type> varchar(250) </type>
	  <parameters> not null </parameters>
	</version>
	<version_epoch/>
	<version_major> 
	  <type> integer </type>
	</version_major>
	<version_minor> 
	  <type> integer </type>
	</version_minor>
	<version_release/>
	<version_subversion/>
      </fields>
    </packages>	

    <packages_conflicts>
      <fields> 
        <package/>
	<type/>
	<name/>
      </fields>
    </packages_conflicts>

    <packages_filters>
      <fields>
        <architecture/>
        <distribution/>
        <distribution_version/>
        <package_id>
	  <type> integer </type>
	</package_id>
        <package_version/>
      </fields>
    </packages_filters>

    <packages_provides>
      <fields> 
        <package/>
	<type/>
	<name/>
      </fields>
    </packages_provides>

    <packages_requires>
      <fields> 
        <package/>
	<type/>
	<name/>
      </fields>
    </packages_requires>

    <packages_rpmlists>
      <fields>
        <architecture/>
        <distribution/>
        <distribution_version/>
        <group/>
        <package_id>
	  <type> integer </type>
	</package_id>
        <package_version/>
        <rpm/>        
      </fields>
    </packages_rpmlists>

  </database_tables>

</oscar>
