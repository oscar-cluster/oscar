# -*- shell-script -*-
#
# $Id: configure.in,v 1.7 2002/02/28 05:32:55 jsquyres Exp $
#
# $COPYRIGHT$
#

# Init autoconf

AC_INIT(./doc/installation/install.tex)
AC_CONFIG_AUX_DIR(./dist)

# Get the version of OSCAR that we are installing

get_version="sh $srcdir/dist/get-oscar-version.sh $srcdir"
OSCAR_VERSION="`eval $get_version --full`"
OSCAR_MAJOR_VERSION="`eval $get_version --major`"
OSCAR_MINOR_VERSION="`eval $get_version --minor`"
OSCAR_RELEASE_VERSION="`eval $get_version --release`"
OSCAR_ALPHA_VERSION="`eval $get_version --alpha`"
OSCAR_BETA_VERSION="`eval $get_version --beta`"

AC_SUBST(OSCAR_MAJOR_VERSION)
AC_SUBST(OSCAR_MINOR_VERSION)
AC_SUBST(OSCAR_RELEASE_VERSION)
AC_SUBST(OSCAR_ALPHA_VERSION)
AC_SUBST(OSCAR_BETA_VERSION)
AC_SUBST(OSCAR_VERSION)

echo "Configuring OSCAR version $OSCAR_VERSION"

# Intialize automake

AM_INIT_AUTOMAKE(oscar, $OSCAR_VERSION, 'no')

# Just because we might as well... :-)

AC_CANONICAL_HOST

# Make automake clean emacs ~ files for "make clean"

CLEANFILES="*~ .*~ .\#*"
AC_SUBST(CLEANFILES)

# Look for things to make the .tex documentation

AC_CHECK_PROG(LATEX, latex, latex)
AC_CHECK_PROG(PDFLATEX, pdflatex, pdflatex)
AC_CHECK_PROG(DVIPS, dvips, dvips)
AC_CHECK_PROG(FIG2DEV, fig2dev, fig2dev)
AC_CHECK_PROG(EPS2PDF, eps2pdf, eps2pdf)
AC_CHECK_PROG(PNGTOPNM, pngtopnm, pngtopnm)
AC_CHECK_PROG(PNMTOPS, pnmtops, pnmtops)

# Look for things that we need to download files remotely

AC_CHECK_PROG(WGET, wget, wget)

# Generate all the necessary files

AC_OUTPUT([
    Makefile

    dist/Makefile
    dist/programs.sh

    doc/Makefile
    doc/architecture/Makefile
    doc/by-laws/Makefile
    doc/development/Makefile
    doc/installation/Makefile
    doc/installation/version.tex
    doc/introduction/Makefile
    doc/introduction/version.tex

    lib/Makefile
    lib/OSCAR/Makefile

    images/Makefile

    oscarsamples/Makefile

    packages/lam/Makefile
    packages/lam/RPMS/Makefile
    packages/lam/SRPMS/Makefile
    packages/mpich/RPMS/Makefile
    packages/mpich/SRPMS/Makefile
    packages/mpich/scripts/Makefile
    packages/mpich/Makefile
    packages/Makefile
    packages/c3/RPMS/Makefile
    packages/c3/scripts/Makefile
    packages/c3/Makefile
    packages/contrib/RPMS/Makefile
    packages/contrib/Makefile
    packages/pbs/RPMS/Makefile
    packages/pbs/scripts/Makefile
    packages/pbs/Makefile
    packages/pvm/RPMS/Makefile
    packages/pvm/SRPMS/Makefile
    packages/pvm/Makefile
    packages/sis/RPMS/Makefile
    packages/sis/Makefile

    scripts/Makefile

    testing/Makefile
    testing/OSCAR_test/Makefile
    testing/OSCAR_test/mpi/Makefile
    testing/OSCAR_test/pvm/Makefile
    testing/OSCAR_test/shell/Makefile
])

